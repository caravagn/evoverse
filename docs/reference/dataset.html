<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an <code>evoverse</code> dataset. — dataset • evoverse</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an <code>evoverse</code> dataset. — dataset" />
<meta property="og:description" content="An evoverse dataset contains, for one or more bulk samples
of the same tumour, the following sequencing information:
mutation data, in the usual format of substitutions involving
one or more nucleotides;
absolute copy number data, reported as segments profiles;
sample purity (proportion of tumour cells in each one of the samples).
This method uses all these information to create an object of
class mbs_data, which provides different S3 methods to
print, visualize and query the loaded data.
Two different types of data formats for mutation and copy number data
are supported by this function, which will try to determine
automatically the type of input. All other parameters have a trivial
data type, independently of mutation and copy number segments data.
Format one for mutations and copy number segments (minimum information
required):

A `dataframe` that must contain mutation coordinates as `chr`,
`from`, `to` in `hg19` chromosome coordinates, plus `ref` and `alt`
for the reference and alternative alleles. For every sample `X`,
this dataframe must contain columns `X.DP`, `X.NV` and `X.VAF` for the depth
(total number of reads with both alleles), the number of reads
with the alternative allele and the allele frequency (VAF = NV/DP).
Chromosome names must be in the format `chr1`, `chr2`, etc.; alleles should
be characters and all other fields numeric.
A `dataframe` that must contain copy number segments as `chr`,
`from`, `to` in `hg19` chromosome coordinates, plus `X.Major` and `X.minor`
for the number of copies of the major allele, and the minor (B-allele)
allele in sample `X`'s segment. Chromosome names must be in the same
format used by mutations.


Format two for mutations and copy number segments (minimum information
required):

A list of `dataframes` that contains mutations for a unique sample
(instead than for all of the samples). Mutation genomic coordinates
must follow the same guidelines and format discussed above, but this time
the list entry for patient `X` can have columns `DP`, `NV` and `VAF`
with the usual meaning. The list should be named, therefore the dataframe
for sample `X` should be named `X`.
A list of `dataframes` that contains segments. As for mutations, in the list
named for patient `X` the major an minor alleles can just be named `Major` and
`minor` (i.e., without the sample appearing the column name).


Regardless the format, mutations are identified using as key the chromosome
name, the genome location, the reference and alternative alleles. For instance,
a SNV with a C&amp;gt;T substitution at chromosome 6, and nucleotide 10048079 will have
id &quot;chr6:10048079:10048079:C:T&quot;. The ids are used to create an internal
representation of the data that allows easy querys and modifications; and are
accessibly with function keys. Extra columns
available in the mutation and copy number data will be retained in internal
representation of the data, and won't be manipulated.
Important consistency requirements: this function makes basic checks of
input consistency, flagging dubious inputs and in some cases refusing to proceed.
It is important that the user checks that:
All mutations are annotated in every sample, even if absent. So even if a mutation
`x``has VAF 0 in a sample, its actual depth, NV, and VAF should be annotated.
Copy number segments should be spanning the same intervals across all the input
samples. So this means that segments calls are joinly called even if the samples are
analysed independently.


Important note: this package uses the CNAqc package to map mutations
to copy number segments, and processing/ visualising copy number calls. Please see the
webpage https://github.com/caravagn/CNAqc for how to use this
package to asses the quality of your copy number calls." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">evoverse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/evoverse.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Colorectal_Cross.html">Subclonal deconvolution of MSeq multi-region WGS colorectal cancer data</a>
    </li>
    <li>
      <a href="../articles/packages.html">Packages in the `evoverse`</a>
    </li>
    <li>
      <a href="../articles/pipelines.html">Pipeline available with the `evoverse` packages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/caravagn/evoverse">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an <code>evoverse</code> dataset.</h1>
    <small class="dont-index">Source: <a href='https://github.com/caravagn/evoverse/blob/master/R/Dataset.R'><code>R/Dataset.R</code></a></small>
    <div class="hidden name"><code>dataset.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An <code>evoverse</code> dataset contains, for one or more bulk samples
of the same tumour, the following sequencing information:</p><ol>
<li><p>mutation data, in the usual format of substitutions involving
one or more nucleotides;</p></li>
<li><p>absolute copy number data, reported as segments profiles;</p></li>
<li><p>sample purity (proportion of tumour cells in each one of the samples).</p></li>
</ol><p>This method uses all these information to create an object of
class <code>mbs_data</code>, which provides different S3 methods to
print, visualize and query the loaded data.</p>
<p>Two different types of data formats for mutation and copy number data
are supported by this function, which will try to determine
automatically the type of input. All other parameters have a trivial
data type, independently of mutation and copy number segments data.</p>
<p>Format one for mutations and copy number segments (minimum information
required):</p>
<ul>
<li><p>A `dataframe` that must contain mutation coordinates as `chr`,
`from`, `to` in `hg19` chromosome coordinates, plus `ref` and `alt`
for the reference and alternative alleles. For every sample `X`,
this dataframe must contain columns `X.DP`, `X.NV` and `X.VAF` for the depth
(total number of reads with both alleles), the number of reads
with the alternative allele and the allele frequency (<code>VAF = NV/DP</code>).
Chromosome names must be in the format `chr1`, `chr2`, etc.; alleles should
be characters and all other fields numeric.</p></li>
<li><p>A `dataframe` that must contain copy number segments as `chr`,
`from`, `to` in `hg19` chromosome coordinates, plus `X.Major` and `X.minor`
for the number of copies of the major allele, and the minor (B-allele)
allele in sample `X`'s segment. Chromosome names must be in the same
format used by mutations.</p></li>
</ul>

<p>Format two for mutations and copy number segments (minimum information
required):</p>
<ul>
<li><p>A list of `dataframes` that contains mutations for a unique sample
(instead than for all of the samples). Mutation genomic coordinates
must follow the same guidelines and format discussed above, but this time
the list entry for patient `X` can have columns `DP`, `NV` and `VAF`
with the usual meaning. The list should be named, therefore the dataframe
for sample `X` should be named `X`.</p></li>
<li><p>A list of `dataframes` that contains segments. As for mutations, in the list
named for patient `X` the major an minor alleles can just be named `Major` and
`minor` (i.e., without the sample appearing the column name).</p></li>
</ul>

<p>Regardless the format, mutations are identified using as key the chromosome
name, the genome location, the reference and alternative alleles. For instance,
a SNV with a C&gt;T substitution at chromosome 6, and nucleotide 10048079 will have
id <code>"chr6:10048079:10048079:C:T"</code>. The ids are used to create an internal
representation of the data that allows easy querys and modifications; and are
accessibly with function <code>keys</code>. Extra columns
available in the mutation and copy number data will be retained in internal
representation of the data, and won't be manipulated.</p>
<p><strong>Important consistency requirements:</strong> this function makes basic checks of
input consistency, flagging dubious inputs and in some cases refusing to proceed.
It is important that the user checks that:</p><ul>
<li><p>All mutations are annotated in every sample, even if absent. So even if a mutation
`x``has VAF 0 in a sample, its actual depth, NV, and VAF should be annotated.</p></li>
<li><p>Copy number segments should be spanning the same intervals across all the input
samples. So this means that segments calls are joinly called even if the samples are
analysed independently.</p></li>
</ul>

<p><strong>Important note:</strong> this package uses the <code>CNAqc</code> package to map mutations
to copy number segments, and processing/ visualising copy number calls. Please see the
webpage <a href='https://github.com/caravagn/CNAqc'>https://github.com/caravagn/CNAqc</a> for how to use this
package to asses the quality of your copy number calls.</p>
    </div>

    <pre class="usage"><span class='fu'>dataset</span>(<span class='no'>mutations</span>, <span class='no'>segments</span>, <span class='no'>samples</span>, <span class='no'>purity</span>,
  <span class='kw'>description</span> <span class='kw'>=</span> <span class='st'>"My evoverse dataset"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mutations</th>
      <td><p>Dataframe of mutations in all samples, or list of dataframes of
mutations, one entry per sample. The formats and requirements are describe above.</p></td>
    </tr>
    <tr>
      <th>segments</th>
      <td><p>Dataframe of copy number segments in all samples, or list of dataframes of
copy number segments, one entry per sample. The formats and requirements are describe above.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>Vector of samples names.</p></td>
    </tr>
    <tr>
      <th>purity</th>
      <td><p>Vector of purities, named consistently to <code>samples</code>.</p></td>
    </tr>
    <tr>
      <th>description</th>
      <td><p>Dataset synopsis.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object that represents a dataset from class <code>mbs_data</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Two related packages developed by Giulio Caravagna</p><ul>
<li><p>MOBSTER, the model-based approach to cluster tumour sequencing
data, available at <a href='https://github.com/caravagn/MOBSTER'>https://github.com/caravagn/MOBSTER</a>.</p></li>
<li><p>CNAqc, the Copy Number Analysis quality check package,
 available at <a href='https://github.com/caravagn/CNAqc'>https://github.com/caravagn/CNAqc</a>.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>'example_evoverse'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: data set ‘example_evoverse’ not found</span></div><div class='input'><span class='no'>mutations</span> <span class='kw'>=</span> <span class='no'>example_mvmobster</span>$<span class='no'>mutations</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'example_mvmobster' not found</span></div><div class='input'><span class='no'>segments</span> <span class='kw'>=</span> <span class='no'>example_mvmobster</span>$<span class='no'>segments</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'example_mvmobster' not found</span></div><div class='input'><span class='no'>purity</span> <span class='kw'>=</span> <span class='no'>example_mvmobster</span>$<span class='no'>purity</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'example_mvmobster' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


